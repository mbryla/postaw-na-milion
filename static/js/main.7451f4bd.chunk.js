(this["webpackJsonppostaw-na-milion"]=this["webpackJsonppostaw-na-milion"]||[]).push([[0],{15:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var s=n(1),o=n.n(s),i=n(9),a=n.n(i),r=(n(15),n(2)),c=n(6),u=n(10),d=n(0),l=function(e){var t=e.color,n=void 0===t?"#efefef":t,s=e.disabled,o=e.onClick,i=e.children,a=e.style,r=void 0===a?{}:a,l=Object(u.a)(e,["color","disabled","onClick","children","style"]);return Object(d.jsx)("button",Object(c.a)(Object(c.a)({style:Object(c.a)({backgroundColor:s?"#efefef":n,marginRight:"10px",padding:"5px"},r),onClick:o,disabled:s},l),{},{children:i}))},j=function(e){var t=e.authKey,n=e.setAuthKey,o=Object(s.useState)(t),i=Object(r.a)(o,2),a=i[0],c=i[1];return Object(d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(d.jsx)("label",{htmlFor:"auth-key",children:"klucz dost\u0119pu:"}),Object(d.jsx)("input",{autoFocus:!0,type:"password",value:a,onChange:function(e){c(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&n(a)},style:{flexGrow:1,margin:"0 10px"}}),Object(d.jsx)(l,{onClick:function(){n(a)},color:"lightcoral",children:"zmie\u0144"})]})},b=function(e){var t=e.setMode;return Object(d.jsxs)("div",{style:{marginTop:"20px",display:"flex",justifyContent:"center"},children:[Object(d.jsx)(l,{onClick:function(){t("player")},style:{marginRight:"40px"},children:"gracz"}),Object(d.jsx)(l,{onClick:function(){t("admin")},children:"admin"})]})},y=n(4),p=Object(s.createContext)(void 0),g="events",h=function(e){var t=Object(s.useMemo)((function(){return{message:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){console.debug("received message",t),t.channel===g&&e(t.message)}))}}),[e]),n=Object(s.useContext)(p);if(!n)throw new Error("PubNubContext is undefined");Object(s.useEffect)((function(){return n.addListener(t),n.subscribe({channels:["events"]}),function(){return null===n||void 0===n?void 0:n.removeListener(t)}}),[n,t])},f=function(e){var t=e.questions,n=e.usedQuestions,s=e.usedCategories;return Object(d.jsxs)("div",{children:[Object(d.jsxs)("h1",{children:["Wczytane pytania (",t.length,")"]}),Object(d.jsx)("ul",{children:t.map((function(e){return Object(d.jsxs)("li",{children:[Object(d.jsx)("span",{style:{textDecoration:n.includes(e.id)?"line-through":"none"},children:e.text}),Object(d.jsxs)("ul",{children:[Object(d.jsxs)("li",{children:["kategorie:"," ",e.possibleCategories.filter((function(t,n){return!s.includes("".concat(e.id,"-").concat(n))})).join(", ")]}),Object(d.jsxs)("li",{children:["zu\u017cyte kategorie:"," ",Object(d.jsx)("span",{style:{textDecoration:"line-through"},children:e.possibleCategories.filter((function(t,n){return s.includes("".concat(e.id,"-").concat(n))})).join(", ")})]}),Object(d.jsxs)("li",{children:["odpowiedzi: ",e.answers.join(", ")]})]})]},e.id)}))})]})},m={type:"game-state-show-title"},x={type:"round-state-empty"},O={type:"admin-state-empty"},w=function(e){var t=e.onQuestionsLoad,n=Object(s.useState)(""),o=Object(r.a)(n,2),i=o[0],a=o[1],c=function(){var e=JSON.parse(i),n={};e.forEach((function(e){return n[e.id]=e})),t(n)};return Object(d.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[Object(d.jsx)("label",{htmlFor:"questions",children:"wczytaj pytania:"}),Object(d.jsx)("input",{type:"text",value:i,onChange:function(e){a(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&c()},style:{flexGrow:1,margin:"0 10px"}}),Object(d.jsx)(l,{onClick:function(){c()},color:"lightcoral",children:"wczytaj"})]})},C=function(){var e=Object(s.useState)(O),t=Object(r.a)(e,2),n=t[0],o=t[1],i=Object(s.useState)(m),a=Object(r.a)(i,2),c=a[0],u=a[1],j=function(){var e=Object(s.useContext)(p);if(!e)throw new Error("PubNubContext is undefined");return Object(s.useCallback)((function(t){return e.publish({channel:g,message:t})}),[e])}();h((function(e){"admin-state-update"===e.type?o(e.state):"game-state-update"===e.type&&u(e.state)}));var b=function(e){j({type:"admin-state-update",state:e})},C=function(e){j({type:"game-state-update",state:e})},k=function(e){j(e).then((function(){console.debug('successfully sent "'.concat(e.type,'" message'))})).catch((function(t){console.error('failed to send "'.concat(e.type,'" message')),console.debug(t)}))};return Object(d.jsxs)("div",{children:["admin-state-base"===n.type&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h1",{children:"Nawigacja"}),"manual"===n.questionsSelectionMode&&Object(d.jsx)(l,{disabled:("game-state-show-title"===c.type||"game-state-show-status"===c.type)&&"round-state-empty"===n.roundState.type,onClick:function(){},style:{marginBottom:"10px"},children:"wybierz pytania"}),Object(d.jsx)(l,{disabled:!(("game-state-show-title"===c.type||"game-state-show-status"===c.type)&&"round-state-empty"===n.roundState.type),onClick:function(){if("admin-state-base"===n.type){var e=Object.values(n.questionsById),t=e.filter((function(e){return!n.usedQuestions.includes(e.id)})).filter((function(e){return!e.shouldBeAskedLast}));if(0===t.length&&0===(t=e.filter((function(e){return!n.usedQuestions.includes(e.id)}))).length)return;var s=t[0],o=1===t.length?s:t[1],i=s.possibleCategories.findIndex((function(e,t){return!n.usedCategories.includes("".concat(s.id,"-").concat(t))})),a=s.possibleCategories[i],r="".concat(s.id,"-").concat(i),c=o.possibleCategories.findIndex((function(e,t){return![].concat(Object(y.a)(n.usedCategories),[r]).includes("".concat(o.id,"-").concat(t))})),u=o.possibleCategories[c],d="".concat(o.id,"-").concat(c);b({type:"admin-state-base",questionsSelectionMode:n.questionsSelectionMode,usedQuestions:n.usedQuestions,questionsById:n.questionsById,answeredQuestionsCount:n.answeredQuestionsCount,usedCategories:[].concat(Object(y.a)(n.usedCategories),[r,d]),roundState:{type:"round-state-select-category",firstQuestion:s,firstQuestionCategory:a,secondQuestion:o,secondQuestionCategory:u}}),C({type:"game-state-show-categories",categories:[a,u]})}},color:"lightgreen",style:{marginBottom:"10px"},children:"rozpocznij rund\u0119"}),Object(d.jsx)(l,{disabled:!("round-state-show-question"===n.roundState.type),color:"lightgreen",onClick:function(){"admin-state-base"===n.type&&"round-state-show-question"===n.roundState.type&&"game-state-show-question"===c.type&&(k({type:"reset-timer-60"}),b({type:"admin-state-base",questionsSelectionMode:n.questionsSelectionMode,questionsById:n.questionsById,answeredQuestionsCount:n.answeredQuestionsCount,usedCategories:n.usedCategories,usedQuestions:n.usedQuestions,roundState:{type:"round-state-select-answers",question:n.roundState.question}}),C({type:"game-state-show-question",answers:c.answers,selectedAnswers:c.selectedAnswers,question:n.roundState.question.text}))},style:{marginBottom:"10px"},children:"poka\u017c pytanie"}),Object(d.jsx)(l,{disabled:!("round-state-select-answers"===n.roundState.type)||"game-state-show-question"===c.type&&0===c.selectedAnswers.filter((function(e){return!0===e})).length,onClick:function(){"admin-state-base"===n.type&&"round-state-select-answers"===n.roundState.type&&"game-state-show-question"===c.type&&(k({type:"stop-timer"}),b({type:"admin-state-base",questionsSelectionMode:n.questionsSelectionMode,questionsById:n.questionsById,answeredQuestionsCount:n.answeredQuestionsCount,usedCategories:n.usedCategories,usedQuestions:n.usedQuestions,roundState:{type:"round-state-empty"}}),C({type:"game-state-show-question",answers:c.answers,selectedAnswers:c.selectedAnswers,question:n.roundState.question.text,correctAnswerIndex:n.roundState.question.correctAnswerIndex}))},color:"lightgreen",style:{marginBottom:"10px"},children:"poka\u017c poprawne odpowiedzi"}),Object(d.jsx)(l,{disabled:!("game-state-show-question"===c.type&&void 0!==c.correctAnswerIndex),onClick:function(){if("admin-state-base"===n.type&&"game-state-show-question"===c.type&&void 0!==c.correctAnswerIndex){var e=n.answeredQuestionsCount,t=Object.keys(n.questionsById).length;b({type:"admin-state-base",questionsSelectionMode:n.questionsSelectionMode,questionsById:n.questionsById,usedCategories:n.usedCategories,usedQuestions:n.usedQuestions,answeredQuestionsCount:e,roundState:{type:"round-state-empty"}}),C(e===t?{type:"game-state-show-title"}:{type:"game-state-show-status",answeredQuestionsCount:e,totalQuestionsCount:t})}},color:"lightgreen",style:{marginBottom:"10px"},children:"poka\u017c podsumowanie"}),Object(d.jsx)(q,{send:k}),("round-state-select-category"===n.roundState.type||"round-state-select-answers"===n.roundState.type)&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h1",{children:"Rozgrywka"}),"round-state-select-category"===n.roundState.type&&Object(d.jsx)(S,{changeAdminState:b,changeGameState:C,adminState:n,gameState:c}),"round-state-select-answers"===n.roundState.type&&Object(d.jsx)(v,{changeAdminState:b,changeGameState:C,adminState:n,gameState:c})]})]}),"admin-state-base"===n.type&&Object(d.jsx)(f,{questions:Object.values(n.questionsById),usedQuestions:n.usedQuestions,usedCategories:n.usedCategories}),Object(d.jsx)(Q,{adminState:n,changeAdminState:b,gameState:c,changeGameState:C}),Object(d.jsx)("h1",{children:"Konfiguracja serwisu"}),Object(d.jsx)(w,{onQuestionsLoad:function(e){b({type:"admin-state-base",questionsSelectionMode:"automatic",usedQuestions:[],usedCategories:[],answeredQuestionsCount:0,roundState:x,questionsById:e}),C(m)}})]})},v=function(e){var t=e.adminState,n=e.gameState,s=e.changeGameState;if("admin-state-base"!==t.type||"round-state-select-answers"!==t.roundState.type)return null;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Prze\u0142\u0105cz zaznaczenie odpowiedzi"}),t.roundState.question.answers.map((function(e,o){return Object(d.jsx)(l,{onClick:function(){return function(e){if("admin-state-base"===t.type&&"round-state-select-answers"===t.roundState.type&&"game-state-show-question"===n.type){var o=Object(y.a)(n.selectedAnswers);o[e]=!o[e],s({type:"game-state-show-question",question:n.question,answers:n.answers,selectedAnswers:o})}}(o)},color:"game-state-show-question"===n.type&&n.selectedAnswers[o]?"yellow":"lightyellow",style:{marginBottom:"10px"},children:e},e)}))]})},S=function(e){var t=e.adminState,n=e.changeAdminState,s=e.changeGameState;if("admin-state-base"!==t.type||"round-state-select-category"!==t.roundState.type)return null;var o=function(e){if("admin-state-base"===t.type&&"round-state-select-category"===t.roundState.type){var o=0===e?t.roundState.firstQuestion:t.roundState.secondQuestion;n({type:"admin-state-base",questionsSelectionMode:t.questionsSelectionMode,usedQuestions:[].concat(Object(y.a)(t.usedQuestions),[o.id]),questionsById:t.questionsById,answeredQuestionsCount:t.answeredQuestionsCount+1,usedCategories:t.usedCategories,roundState:{type:"round-state-show-question",question:o}}),s({type:"game-state-show-question",answers:o.answers,selectedAnswers:new Array(o.answers.length).fill(!1)})}};return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Wska\u017c wybran\u0105 kategori\u0119"}),Object(d.jsx)(l,{onClick:function(){return o(0)},color:"lightgreen",children:t.roundState.firstQuestionCategory}),Object(d.jsx)(l,{onClick:function(){return o(1)},color:"lightgreen",children:t.roundState.secondQuestionCategory})]})},q=function(e){var t=e.send;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Zegar"}),Object(d.jsxs)("div",{children:[Object(d.jsx)(l,{onClick:function(){return t({type:"start-timer"})},style:{marginBottom:"10px"},children:"start"}),Object(d.jsx)(l,{onClick:function(){return t({type:"stop-timer"})},style:{marginBottom:"10px"},children:"stop"}),Object(d.jsx)(l,{onClick:function(){return t({type:"reset-timer-60"})},style:{marginBottom:"10px"},children:"reset 60s"}),Object(d.jsx)(l,{onClick:function(){return t({type:"reset-timer-30"})},style:{marginBottom:"10px"},children:"reset 30s"})]})]})},Q=function(e){var t=e.adminState,n=e.changeAdminState,s=e.gameState,o=e.changeGameState;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Synchronizacja"}),Object(d.jsx)(l,{onClick:function(){n(t),o(s)},color:"yellow",children:"wymu\u015b propagacj\u0119 stanu"}),Object(d.jsx)(l,{onClick:function(){n(O),o(m)},color:"lightcoral",children:"resetuj stan"})]})},k=function(e,t){return("0".repeat(t)+e).slice(-1*t)},I=function(e){var t=e.value,n=Math.floor(t/6e4),s=Math.floor(t/1e3)%60;return Object(d.jsxs)("span",{children:[k(n,2),":",k(s,2)]})},A=function(e){var t=e.children,n=e.isSelected,s=void 0!==n&&n,o=e.isCorrect,i=void 0===o?"#f1f1f1":o?"lightgreen":"lightcoral";return Object(d.jsx)("div",{style:{margin:"20px",padding:"20px",backgroundColor:i,borderRadius:"8px",border:"2px solid gray",boxShadow:s?"0 0 7pt 7pt yellow":"none",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center"},children:t})},B=function(e){var t=e.question,n=e.answers,s=e.selectedAnswers,o=e.correctAnswerIndex,i=e.time;return Object(d.jsxs)(d.Fragment,{children:[t&&Object(d.jsx)(A,{children:t}),n&&s&&Object(d.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"space-around"},children:n.map((function(e,t){var n=s[t],i=void 0===o?void 0:o===t;return Object(d.jsx)(A,{isSelected:n,isCorrect:i,children:e},e)}))}),void 0!==i&&Object(d.jsx)(A,{isSelected:i<=1e4&&i>0||void 0,isCorrect:0!==i&&void 0,children:Object(d.jsx)(I,{value:i})})]})},z=function(e){var t=e.categories;return Object(d.jsx)(d.Fragment,{children:t.map((function(e){return Object(d.jsx)(A,{children:e},e)}))})},M=function(e){var t=e.answeredQuestionsCount,n=e.totalQuestionsCount;return Object(d.jsxs)(A,{children:["odpowiedziano na ",t===n?n:t," z ",n," pyta\u0144"]})},K=function(){return Object(d.jsx)("img",{src:"./postaw-na-milion-logo.png",alt:"logo",style:{width:"60%"}})},F=6e4,E=function(){var e=Object(s.useState)(m),t=Object(r.a)(e,2),n=t[0],o=t[1],i=Object(s.useState)(!1),a=Object(r.a)(i,2),c=a[0],u=a[1],l=Object(s.useState)(F),j=Object(r.a)(l,2),b=j[0],y=j[1];return h((function(e){"game-state-update"===e.type?o(e.state):"reset-timer-60"===e.type?y(F):"reset-timer-30"===e.type?y(3e4):"start-timer"===e.type?u(!0):"stop-timer"===e.type&&u(!1)})),function(e,t){var n=Object(s.useRef)();Object(s.useEffect)((function(){n.current=e}),[e]),Object(s.useEffect)((function(){if(void 0!==t){var e=setInterval((function(){var e;return null===(e=n.current)||void 0===e?void 0:e.call(n)}),t);return function(){return clearInterval(e)}}}),[t])}((function(){y((function(e){return e-1e3}))}),c&&b>0?1e3:void 0),Object(d.jsxs)("div",{style:{width:"100wh",height:"100vh",display:"flex",flexDirection:"column",justifyContent:"space-around",alignItems:"center",background:"linear-gradient(to right, #0575e6, #021b79)",fontSize:"2em"},children:["game-state-show-title"===n.type&&Object(d.jsx)(K,{}),"game-state-show-status"===n.type&&Object(d.jsx)(M,{answeredQuestionsCount:n.answeredQuestionsCount,totalQuestionsCount:n.totalQuestionsCount}),"game-state-show-categories"===n.type&&Object(d.jsx)(z,{categories:n.categories}),"game-state-show-question"===n.type&&Object(d.jsx)(B,{question:n.question,answers:n.answers,selectedAnswers:n.selectedAnswers,correctAnswerIndex:n.correctAnswerIndex,time:n.question?b:void 0})]})},G=n(8),D=n.n(G),L=function(e){var t=e.authKey,n=e.children,o=Object(s.useMemo)((function(){return D.a.generateUUID()}),[]),i=Object(s.useMemo)((function(){return console.debug("Generating new PubNub instance"),new D.a({publishKey:"pub-c-9efb5740-fca0-4887-b38b-b919ba6becc9",subscribeKey:"sub-c-387cb370-6b1a-11eb-9994-e2667f94577d",authKey:t,uuid:o})}),[t,o]);return t?Object(d.jsx)(p.Provider,{value:i,children:n}):null},P=function(){var e=Object(s.useState)(),t=Object(r.a)(e,2),n=t[0],o=t[1],i=Object(s.useState)(""),a=Object(r.a)(i,2),c=a[0],u=a[1];return Object(d.jsxs)("main",{children:[void 0===n&&Object(d.jsx)(b,{setMode:o}),"player"===n&&Object(d.jsx)(L,{authKey:"public",children:Object(d.jsx)(E,{})}),"admin"===n&&Object(d.jsxs)("div",{style:{padding:"20px"},children:[c&&Object(d.jsx)(L,{authKey:c,children:Object(d.jsx)(C,{})}),Object(d.jsx)(j,{authKey:c,setAuthKey:u})]})]})},N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,s=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),s(e),o(e),i(e),a(e)}))};a.a.render(Object(d.jsx)(o.a.StrictMode,{children:Object(d.jsx)(P,{})}),document.getElementById("root")),N()}},[[17,1,2]]]);
//# sourceMappingURL=main.7451f4bd.chunk.js.map